{% extends "base.html" %}

{% block main_title %} {{ title }} {% endblock %}

{% block main_body %}
    <hr xmlns="http://www.w3.org/1999/html">

    {% if categories %}
        <form>
            <label for="categories">Category
                <select name="categories">
                    <option value="0" {% if cat_selected is None %} selected {% endif %}>---</option>
                    {% for category in categories %}
                        <option value="{{ category.pk }}"
                            {% if category.pk == cat_selected %} selected {% endif %}
                        >{{ category.name }}</option>
                    {% endfor %}
                </select>
            </label>
            <button type="submit">Filter</button>
        </form>
    {% endif %}

    {% if posts|length > 0 %}

        <div>
            {% for post in posts %}
                 <a href="{% url 'post-detail' post.blog.slug post.pk %}" class="post">
                    <strong>{{ post.title }}</strong>
                    <br>
                    {%  if post.image %}
                       <img src="{{ post.image.url }}" alt="{{ post.title }}" title="{{ post.title }}">
                        <br>
                    {% endif %}
                    <p>{{ post.summary }}</p>
                    {% for category in post.categories.all %}
                        {{ category.name }}
                    {% endfor %}
                    <em>Posted by {{ post.author.first_name }} {{ post.author.last_name }}</em>
                </a>
                <hr>
            {% endfor %}
        </div>

        <div class="pagination">
            <span class="step-links">
                {% if posts.has_previous %}
                    <a href="?page=1">&laquo; first</a>
                    <a href="?page={{ posts.previous_page_number }}">previous</a>
                {% endif %}

                <span class="current">
                    Page {{ posts.number }} of {{ posts.paginator.num_pages }}.
                </span>

                {% if posts.has_next %}
                    <a href="?page={{ posts.next_page_number }}">next</a>
                    <a href="?page={{ posts.paginator.num_pages }}">last &raquo;</a>
                {% endif %}
            </span>
        </div>

    {% else %}

        <h2>No posts yet...</h2>

    {% endif %}

{% endblock %}